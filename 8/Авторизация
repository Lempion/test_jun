Как поступил бы я:


1 - Код

    1. Сделать поле в таблице user с названием code_auth

    2. При авторизации на сайте, создаётся код из 4 чисел и записывается в БД, так же создаётся кука жизни этого кода

    3. Юзеру отправляется этот код на почту или телефон

    4. Если код правильный тогда он удаляется и поле становится null, и записывается токен авторизации в БД

    5. Если мы не ввели код и время жизни куки вышло тогда нас кидается обратно на авторизацию по новой


2 - Ссылка

    1. При авторизации юзеру на почту приходит ссылка с параметрами ?hash=...?token=...

    2. Данный hash, token можно записать либо в БД, либо в куку

    3. При нажатии на сылку заходим на страницу с проверкой данных

    4. Если всё окей, тогда авторизуем иначе ошибка
